% sample.m% Just a few simple calls to the different functions for % finding the steady flow using space marching% Uses: calcarea.m; %       spacemarch.m (and hence march.m and shock.m)%       findshock.m (and hence spacemarch.m, etc.)clear;for ifig=1:3 % Let's also get rid of any old figures and place new figures  figure(ifig); clf;  set(gcf,'Units','pixels','Position',[(10+ifig)*30+10 (10-ifig)*30+10 750 450]);endgamma = 1.4;    % ratio of specific heats% Entrance conditionsamach0 = 1.50;  % Mach number at the entrance rho0 = 0.50;    % density at the entrance p0 = 0.25;      % pressure at the entrance %xlength = 10.;  % length of the nozzlexsh = 4.0;      % location if use fixed shock location%irefine = 4;          % change this parameter to refine the space mesh (and time)jmax = 40*irefine+1;  % number of mesh points along the nozzle%pexit = 0.7143; % target exit pressure (atmospheric, if non-dimensional)% set-up the mesh with x-location dx = xlength/(jmax-1);x = 0:dx:xlength;% load up the area along the nozzlearea = calcarea(x);figure(1);plot(x,area,'r-','LineWidth',2.0);set(gca,'FontSize',16,'LineWidth',2.0,'FontWeight','demi');title(['Nozzle Geometry Area Variation'])axis([0,xlength,0,1.1*max(area)]);grid on;xlabel(['X']); ylabel(['AREA(X)']);% Let's plot pressure distribution for fixed shock locationfigure(2);hold on;% Using second-order in space (predictor-corrector)[rho_sp,u_sp,p_sp,e_sp,amach_sp]=...            spacemarch(gamma,amach0,p0,rho0,xsh,x,area,1);plot(x,p_sp,'r-','LineWidth',2);% Using first-order in space[rho_sp,u_sp,p_sp,e_sp,amach_sp]=...            spacemarch(gamma,amach0,p0,rho0,xsh,x,area,0);plot(x,p_sp,'g--','LineWidth',2);%endset(gca,'FontSize',16,'LineWidth',2,'FontWeight','demi');title('Pressure Distribution Along Nozzle (fixed shock locations)')grid on;xlabel('X'); ylabel('p');hold off;legend({'Pred-Corr (2nd order)','Pred (1st order)     '},'Location','NorthWest')p_sp(jmax)% Let's plot pressure distribution for target pressure at exit using different% space marching methods (predictor-corrector vs. predictor only)figure(3)xsh1=2.65;xsh2=5.85;% Using predictor-corrector find shock location and plot[xsh]= findshock(gamma,amach0,p0,rho0,xsh1,xsh2,x,area,1,pexit);[rho_sp,u_sp,p_sp,e_sp,amach_sp]=...            spacemarch(gamma,amach0,p0,rho0,xsh,x,area,1);plot(x,p_sp,'r-','LineWidth',2.0);set(gca,'FontSize',16,'LineWidth',2.0,'FontWeight','demi');title('Pressure Distribution Along Nozzle (fixed exit pressure)')grid on;hold on% Using predictor only find shock location and plot[xsh]= findshock(gamma,amach0,p0,rho0,xsh1,xsh2,x,area,0,pexit);[rho_sp,u_sp,p_sp,e_sp,amach_sp]=...            spacemarch(gamma,amach0,p0,rho0,xsh,x,area,0);plot(x,p_sp,'g--','LineWidth',2.0);xlabel('X'); ylabel('p');hold off;% Done